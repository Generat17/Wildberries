Что выведет программа? Объяснить вывод программы. Объяснить как работают defer’ы и их порядок вызовов.

```go
package main

import (
	"fmt"
)


func test() (x int) {
	// x = 0, если ничего не передать

	// откладываем вызов функции
	defer func() {
		x++
	}()
	x = 1

	// Тут вызывается отложенная функция, которая изменяет именованное возвращаемое значение
	return
}


func anotherTest() int {
	var x int // x = 0
	defer func() {
		// x = 1
		x++
		// x = 2, но anotherTest уже вернула 1
	}()
	x = 1
	// тут вызывается отложенная функция, но anotherTest уже вернула 1
	return x
}


func main() {
	fmt.Println(test())
	fmt.Println(anotherTest())
}
```

Ответ:

Вывод программы

2

1

Синтаксически инструкция defer является обычным вызовом функции или метода, которому предшествует ключевое слово defer. Функция и выражения аргументов вычисляются при выполнении инструкции, но фактический вызов откладывается до завершения функции, содержащей инструкцию defer, независимо от того, как она завершается: обычным способом с помощью оператора return или в результате аварийной ситуации. Может быть отложено любое количество вызовов; они выполняются в порядке, обратном тому, в котором они были отложены.

Отложенные функции выполняются после того, как инструкция возврата обновляет переменные результатов функции. Поскольку анонимная функция может обращаться к переменным охватывающей функции, включая именованные результаты, отложенная анонимная функция имеет доступ к результатам функции, в которой вызвана.

Так, в функции test() отложенная функция выполняется после обновления именованного результата функции и поэтому меняет значение результата, а в функции anotherTest() отложенная функция, хоть и увеличивает переменную на единицу, но не имеет доступа к возвращаемому результату.
